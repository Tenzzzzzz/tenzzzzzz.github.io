<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=7865&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <title>Connectors Ctf 2025 Qualification · Pitou</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    
    <link rel="stylesheet" href="/css/blog.css">
</head>
<body class="dark-theme">


    
    <div class="search-modal-overlay" id="searchModal">
        <div class="search-modal">
            <div class="search-modal-header">
                <div class="search-input-wrapper">
                    <svg class="search-input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input 
                        type="text" 
                        class="search-modal-input" 
                        id="searchInput" 
                        placeholder="Search documentation..." 
                        autocomplete="off"
                    >
                    <kbd class="search-esc">ESC</kbd>
                </div>
            </div>
            <div class="search-modal-body" id="searchResults">
                <div class="search-empty-state">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <p>Type to start searching...</p>
                </div>
            </div>
            <div class="search-modal-footer">
                <div class="search-hints">
                    <span class="search-hint">
                        <kbd>↑</kbd><kbd>↓</kbd> Navigate
                    </span>
                    <span class="search-hint">
                        <kbd>↵</kbd> Open
                    </span>
                    <span class="search-hint">
                        <kbd>ESC</kbd> Close
                    </span>
                </div>
            </div>
        </div>
    </div>

    
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <img src="/images/avatar.png" alt="Logo" class="logo-img">
                <span class="logo-text">Pitou</span>
            </div>
        </div>
        <div class="header-right">
            <button class="search-btn" id="searchBtn" onclick="openSearch()">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <span class="search-text">Search...</span>
                <div class="search-shortcut">
                    <kbd>Ctrl</kbd>
                    <kbd>K</kbd>
                </div>
            </button>
        </div>
    </header>

    <div class="layout">

        
        <aside class="sidebar">
            <nav class="sidebar-nav">
                
                
                    
        
        
        
        
        
        
        
        <div class="nav-group has-children expanded root-level">

            <div class="nav-item ">
                <a href="/blog/ctfs-writeups/" class="nav-link">
                    Ctfs Writeups
                </a>
                
                <button class="nav-expand" onclick="this.closest('.nav-group').classList.toggle('expanded')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
                
            </div>

            
            <div class="nav-submenu">
                
                    
        
        
        
        
        
        
        
        <div class="nav-group  ">

            <div class="nav-item ">
                <a href="/blog/ctfs-writeups/1/" class="nav-link">
                    AswanCTF 2025 Finals
                </a>
                
            </div>

            
        </div>
    
                
                    
        
        
        
        
        
        
        
        <div class="nav-group  ">

            <div class="nav-item ">
                <a href="/blog/ctfs-writeups/2/" class="nav-link">
                    Break The Syntax ctf 2025
                </a>
                
            </div>

            
        </div>
    
                
                    
        
        
        
        
        
        
        
        <div class="nav-group  ">

            <div class="nav-item ">
                <a href="/blog/ctfs-writeups/3/" class="nav-link">
                    EG-CERT Ctf 2025 Qualification
                </a>
                
            </div>

            
        </div>
    
                
                    
        
        
        
        
        
        
        
        <div class="nav-group  ">

            <div class="nav-item active">
                <a href="/blog/ctfs-writeups/4/" class="nav-link">
                    Connectors Ctf 2025 Qualification
                </a>
                
            </div>

            
        </div>
    
                
            </div>
            
        </div>
    
                
                    
        
        
        
        
        
        
        
        <div class="nav-group has-children expanded root-level">

            <div class="nav-item ">
                <a href="/blog/crackmes/" class="nav-link">
                    Crackmes challenges
                </a>
                
                <button class="nav-expand" onclick="this.closest('.nav-group').classList.toggle('expanded')">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
                
            </div>

            
            <div class="nav-submenu">
                
                    
        
        
        
        
        
        
        
        <div class="nav-group  ">

            <div class="nav-item ">
                <a href="/blog/crackmes/1/" class="nav-link">
                    Ransomware
                </a>
                
            </div>

            
        </div>
    
                
            </div>
            
        </div>
    
                
            </nav>
        </aside>

        
       
<main class="main-content">
    <div class="content-container">
            <div class="reading-progress" id="readingProgress"></div>

        
        <div class="page-header">
            <h1 class="page-title">Connectors Ctf 2025 Qualification</h1>
        </div>

        
        <article class="article-content">
            <p>I have participated with my Team 0xWraith, and was able to clear all reverse engineering challenges. Here are the solutions to them..</p>
<h2 id="revstarwars">[REV][Starwars]</h2>
<p>We are given a game with 3 files</p>
<figure><img src="/blog_images/ctfs_writeups/4/001.png" alt=""><figcaption></figcaption></figure>
<p>By inspecting the exe file in DIE, we get this</p>
<figure><img src="/blog_images/ctfs_writeups/4/002.png" alt=""><figcaption></figcaption></figure>
<p>It is a game made with the GameMaker engine </p>
<p>Upon opening it, you will be controlling a dart that shoots circles, and your score will increase at the top left.</p>
<figure><img src="/blog_images/ctfs_writeups/4/003.png" alt=""><figcaption></figcaption></figure>
<p>The idea here is that the win condition is not implemented, so let&rsquo;s dig deeper to see what we can do.</p>
<p>The main logic, objects, functions, variables, and fonts of the game are in a file called data.win, and there is an open-source tool called UndertaleModTool that enables you to decompile the game.</p>
<p><a href="https://github.com/UnderminersTeam/UndertaleModTool">UndertaleModTool</a></p>
<p>opening the data.win file -&gt;</p>
<figure><img src="/blog_images/ctfs_writeups/4/004.png" alt=""><figcaption></figcaption></figure>
<p>By exploring the functions, I saw that one</p>
<figure><img src="/blog_images/ctfs_writeups/4/005.png" alt=""><figcaption></figcaption></figure>
<p>This is the win function obviously </p>
<p>the flag drawing is in the draw_text function, so we have to move this code in the obj_game events to be triggered </p>
<figure><img src="/blog_images/ctfs_writeups/4/006.png" alt=""><figcaption></figcaption></figure>
<figure><img src="/blog_images/ctfs_writeups/4/007.png" alt=""><figcaption></figcaption></figure>
<p>And then we see the flag</p>
<figure><img src="/blog_images/ctfs_writeups/4/008.png" alt=""><figcaption></figcaption></figure>
<blockquote>
<p><mark style="color:$info;">CONCTF{WH4t_4_hAck3r_y0u_ar3}</mark></p>
</blockquote>
<h2 id="revyoru">[REV][Yoru]</h2>
<p>We are given a PE file as shown</p>
<figure><img src="/blog_images/ctfs_writeups/4/009.png" alt=""><figcaption></figcaption></figure>
<p>Upon executing it, we are prompted to a window with two input fields :</p>
<figure><img src="/blog_images/ctfs_writeups/4/010.png" alt=""><figcaption></figcaption></figure>
<p>Let&rsquo;s explore the file in IDA to see what is going on</p>
<p>We got so many useless functions for our analysis</p>
<figure><img src="/blog_images/ctfs_writeups/4/011.png" alt=""><figcaption></figcaption></figure>
<p>But since we saw text on the window like {&ldquo;wrong&rdquo;,&ldquo;length&rdquo;,&ldquo;Username&rdquo;} and so on, it is probably hard-coded in the program, and if we use the search text feature in IDA, we will spot an important function in IDA, which checks for username and password.</p>
<p>The function does simple XOR encryption with our input and compares the result to hard hard-coded expected data </p>
<figure><img src="/blog_images/ctfs_writeups/4/012.png" alt=""><figcaption></figcaption></figure>
<figure><img src="/blog_images/ctfs_writeups/4/013.png" alt=""><figcaption></figcaption></figure>
<p>The login info is:</p>
<p>username: &ldquo;Did_you_really&rdquo;</p>
<p>password:&ldquo;fall_for_my_trap?_xD&rdquo;</p>
<figure><img src="/blog_images/ctfs_writeups/4/014.png" alt=""><figcaption></figcaption></figure>
<p>And we got that window mentioning that pc name is wrong, that could be a hint or something.</p>
<p>i found this function that get my computer name and inputs it along with a key (0x7ff7ea47a000) to an encryption function, and then compares the result to hardcoded data in 0x7FF7EA47A010</p>
<p>address</p>
<figure><img src="/blog_images/ctfs_writeups/4/015.png" alt=""><figcaption></figcaption></figure>
<p>by searching inside this encryption function, we find it is the AES_ECB algorithm </p>
<figure><img src="/blog_images/ctfs_writeups/4/016.png" alt=""><figcaption></figcaption></figure>
<p>Since we have the key and the ciphertext, we can decrypt it to obtain the plain text which is the computer name that was supposedly intended, but we still do not know why we need that computer name, any way let&rsquo;s continue</p>
<pre tabindex="0"><code>from Crypto.Cipher import AES

key = bytes([
0x2B, 0x7E, 0x15, 0x16,
0x28, 0xAE, 0xD2, 0xA6,
0xAB, 0xF7, 0x15, 0x88,
0x09, 0xCF, 0x4F, 0x3C
])


result_data= bytes([
0x4F, 0x03, 0xE8, 0xE7,
0x76, 0x8B, 0x0E, 0x8B,
0x29, 0x25, 0x63, 0x62,
0x45, 0x66, 0xD5, 0x1F
])

c= AES.new(key, AES.MODE_ECB)
p= c.decrypt(result_data)


print(p)
</code></pre><blockquote>
<p>C0nN3ctEd_aDmi1n</p>
</blockquote>
<p>by digging deeper in the program, we found that flag check function it takes the pc name as a key and encrypts bytes, and then compares it to the true data.</p>
<figure><img src="/blog_images/ctfs_writeups/4/017.png" alt=""><figcaption></figcaption></figure>
<p>This is a straightforward RC4 decryption:</p>
<pre tabindex="0"><code>def rc4(input_bytes: bytes, key: bytes) -&gt; bytes:
    # Initialize S array like in the binary (256..511)
    S = list(range(256))  # This corresponds to v5[256..511]
    keylen = len(key)
    # Copy key into v5[0..255]
    v = [key[i % keylen] for i in range(256)]

    # KSA (key scheduling)
    j = 0
    for i in range(256):
        j = (j + v[i] + S[i]) &amp; 0xFF
        S[i], S[j] = S[j], S[i]

    # PRGA (stream generation &amp; XOR)
    out = bytearray()
    i = 0
    j = 0
    for b in input_bytes:
        i = (i + 1) &amp; 0xFF
        j = (j + S[i]) &amp; 0xFF
        S[i], S[j] = S[j], S[i]
        K = S[(S[i] + S[j]) &amp; 0xFF]
        out.append(b ^ K)
    return bytes(out)

if __name__ == &#34;__main__&#34;:
	cipher_bytes = bytes([
	0x8F, 0x06, 0xC0, 0x3D, 0x54, 0x9C, 0xFA, 0x26,
	0xCF, 0x14, 0xC8, 0xBC, 0x1D, 0xC7, 0x3B, 0x1B,
	0x9C, 0xE4, 0xD5, 0xDD, 0x1B, 0x9C, 0x61, 0x0B,
	0xD8, 0x8B, 0xAF, 0xD4, 0x3D, 0x5F, 0x25, 0x00,
	0xA0, 0xFA, 0xCA, 0xED, 0xD0, 0xA2, 0x6A, 0x7A,
	0x71, 0x89, 0x3B, 0xD9])

	key = b&#34;C0nN3ctEd_aDmi1n&#34;
	result = rc4(cipher_bytes, key)
	print(result)
</code></pre><blockquote>
<p>CONCTF{c0NNect3d_Successfully_T0_Th3_CTF_:D}</p>
</blockquote>
<h2 id="revroblox-active-developer">[REV][Roblox Active Developer]</h2>
<p>We are given a luac file, we will use <a href="https://luadec.metaworm.site">luadec</a> to decompile it.</p>
<p>We see many dummy function that has nothing to do with the flag, but again, we will search </p>
<p>by words like {&ldquo;flag&rdquo;,&ldquo;correct&rdquo;,&ldquo;wrong&rdquo;}.</p>
<figure><img src="/blog_images/ctfs_writeups/4/018.png" alt=""><figcaption></figcaption></figure>
<p>And we get this function</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>io.write(<span style="color:#e6db74">&#34;Enter flag: &#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> r23_0 <span style="color:#f92672">=</span> r6_0(io.read(<span style="color:#e6db74">&#34;*l&#34;</span>) <span style="color:#f92672">or</span> <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> r24_0 <span style="color:#f92672">=</span> r15_0()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> r26_0 <span style="color:#f92672">=</span> r20_0(r23_0, r24_0, r16_0(r24_0))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> r27_0 <span style="color:#f92672">=</span> <span style="color:#f92672">#</span>r26_0 <span style="color:#f92672">==</span> <span style="color:#f92672">#</span>r21_0
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> r27_0 <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> r31_0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#f92672">#</span>r26_0, <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> r26_0[r31_0] <span style="color:#f92672">~=</span> r21_0[r31_0] <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      r27_0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> r27_0 <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  print(<span style="color:#e6db74">&#34;[+] Correct! You solved it.&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  print(<span style="color:#e6db74">&#34;[-] Nope.&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Note that in that weird language, a &lsquo;#&rsquo; before a var means the length of the data IN the var.</p>
<p>The function seems to do some encryption to our input (r23_0) and compare the result to some data, which is r21_0.</p>
<p>The target_bytes (r21_0) are :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ciphertext <span style="color:#f92672">=</span> [<span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">181</span>, <span style="color:#ae81ff">249</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">124</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">132</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">161</span>, <span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">212</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">194</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">177</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">224</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">243</span>, <span style="color:#ae81ff">226</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">249</span>, <span style="color:#ae81ff">232</span>, <span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">226</span>, <span style="color:#ae81ff">176</span>, <span style="color:#ae81ff">221</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">202</span>, <span style="color:#ae81ff">223</span>]
</span></span></code></pre></div><p>let&rsquo;s see what r15_0 has&hellip;</p>
<p>by extracting all needed functions for r15_0, which are: r11,r5,r12,and the r14_0 variable and running it, we got that array:</p>
<pre tabindex="0"><code>bytes:
[1] = 131
[2] = 73
[3] = 49
[4] = 35
[5] = 131
[6] = 228
[7] = 99
[8] = 178
[9] = 223
[10] = 168
[11] = 84
[12] = 165
[13] = 118
[14] = 83
[15] = 178
[16] = 67
</code></pre><p>And here is the complete code:</p>
<pre tabindex="0"><code>local function r11_0(r0_1012, r1_1012)
-- line: [3058, 3065] id: 1012
local r2_1012 = r1_1012 or 2166136261
for r6_1012 = 1, #r0_1012, 1 do
r2_1012 = (r2_1012 ~ r0_1012[r6_1012]) * 16777619 &amp; 4294967295
end
return r2_1012
end

local function r5_0(r0_1006, r1_1006)
-- line: [3018, 3021] id: 1006
r1_1006 = r1_1006 &amp; 31
return (r0_1006 &lt;&lt; r1_1006 | r0_1006 &gt;&gt; 32 - r1_1006) &amp; 4294967295
end

local function r12_0(r0_1013)
-- line: [3067, 3072] id: 1013
r0_1013 = r0_1013 ~ r0_1013 &lt;&lt; 13 &amp; 4294967295
r0_1013 = r0_1013 ~ r0_1013 &gt;&gt; 17 &amp; 4294967295
r0_1013 = r0_1013 ~ r0_1013 &lt;&lt; 5 &amp; 4294967295
return r0_1013 &amp; 4294967295
end

local r14_0 = {
99, 188, 92, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118
, 202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164, 114, 192
, 183, 253, 147, 38, 54, 63, 247, 140, 52, 165, 229, 241, 113, 216, 49, 21
, 4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 175, 150, 117
, 9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214, 179, 43, 47, 42, 132
, 83, 209, 0, 237, 32, 252, 161, 91, 122, 203, 190, 57, 74, 76, 88, 206
, 209, 239, 170, 237, 32, 252, 185, 91, 190, 203, 190, 57, 74, 76, 88, 206
, 208, 238, 66, 204, 233, 186, 101, 205, 132, 54, 226, 8, 133, 125, 188, 15
, 9, 101, 44, 28, 29, 110, 84, 170, 82, 59, 214, 25, 222, 47, 41, 25
, 97, 129, 79, 220, 20, 20, 144, 26, 74, 16, 170, 20, 223, 43, 10, 219
, 224, 50, 56, 10, 73, 6, 36, 82, 194, 163, 121, 211, 25, 106, 228, 121
, 231, 5, 35, 109, 133, 250, 78, 234, 108, 86, 101, 122, 124, 122, 174, 8
, 186, 120, 37, 46, 28, 166, 181, 200, 232, 221, 116, 223, 148, 31, 139, 138
, 112, 124, 37, 93, 72, 3, 232, 110, 1, 84, 101, 29, 205, 115, 65, 46
, 225, 240, 152, 17, 14, 31, 246, 71, 107, 85, 155, 89, 90, 213, 187, 22
, 140, 161, 137, 13, 191, 230, 163, 96, 65, 153, 45, 47, 73, 84, 187, 186
} -- paste the table definition

-- Copy r15_0 function
function r15_0()
-- line: [6107, 6149] id: 2014
local r0_2014 = {
108,
117,
97
}
local r1_2014 = {
45,
114,
51,
118
}
local r2_2014 = {
45,
99,
104,
97,
108,
108,
101,
110,
103,
101
}
local r3_2014 = {
33
}
local r4_2014 = {}
for r8_2014, r9_2014 in ipairs({
r0_2014,
r1_2014,
r2_2014,
r3_2014
}) do
for r13_2014 = 1, #r9_2014, 1 do
r4_2014[#r4_2014 + 1] = r9_2014[r13_2014]
end
end
local r5_2014 = r11_0(r4_2014)
local r6_2014 = {
3,
1,
4,
1,
5,
9,
2,
6,
5,
3,
5,
8
}
for r10_2014 = 1, #r6_2014, 1 do
local r11_2014 = (r5_2014 ~ r6_2014[r10_2014] * 2654435761 &amp; 4294967295) &amp; 4294967295
r5_2014 = r5_0(r11_0({
[1] = r11_2014 &amp; 255,
[2] = r11_2014 &gt;&gt; 8 &amp; 255,
[3] = r11_2014 &gt;&gt; 16 &amp; 255,
[4] = r11_2014 &gt;&gt; 24 &amp; 255,
}, r11_2014), r6_2014[r10_2014] % 13 + 3)
end
local r7_2014 = r5_2014 ~ 2779096485
local r8_2014 = {}
for r12_2014 = 0, 3, 1 do
r7_2014 = r12_0((r7_2014 ~ 3287226785 + r12_2014 * 2654435761 &amp; 4294967295) &amp; 4294967295)
local r13_2014 = r7_2014 ~ r5_0(r7_2014, r12_2014 + 1) ~ 322420463
r8_2014[#r8_2014 + 1] = r13_2014 &amp; 255
r8_2014[#r8_2014 + 1] = r13_2014 &gt;&gt; 8 &amp; 255
r8_2014[#r8_2014 + 1] = r13_2014 &gt;&gt; 16 &amp; 255
r8_2014[#r8_2014 + 1] = r13_2014 &gt;&gt; 24 &amp; 255
end
for r12_2014 = 1, 16, 1 do
r8_2014[r12_2014] = (r8_2014[r12_2014] ~ r14_0[(r8_2014[(r12_2014 - 2) % 16 + 1] + r12_2014 * 17 &amp; 255) + 1]) &amp; 255
end
return r8_2014
end

-- Run it and print the key
local key = r15_0()
for i = 1, #key do
print(string.format(&#34;[%d] = %d&#34;, i, key[i]))
end
</code></pre><p>Now we need to see what R16_0 outputs.</p>
<p>Here is the code of it</p>
<pre tabindex="0"><code>local function r12_0(r0_1013)
  r0_1013 = r0_1013 ~ r0_1013 &lt;&lt; 13 &amp; 4294967295
  r0_1013 = r0_1013 ~ r0_1013 &gt;&gt; 17 &amp; 4294967295
  r0_1013 = r0_1013 ~ r0_1013 &lt;&lt; 5 &amp; 4294967295
  return r0_1013 &amp; 4294967295
end

local function r11_0(r0_1012, r1_1012)
  local r2_1012 = r1_1012 or 2166136261
  for r6_1012 = 1, #r0_1012, 1 do
    r2_1012 = (r2_1012 ~ r0_1012[r6_1012]) * 16777619 &amp; 4294967295
  end
  return r2_1012
end

local r14_0 = {
  99, 188, 92, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118,
  202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164, 114, 192,
  183, 253, 147, 38, 54, 63, 247, 140, 52, 165, 229, 241, 113, 216, 49, 21,
  4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 175, 150, 117,
  9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214, 179, 43, 47, 42, 132,
  83, 209, 0, 237, 32, 252, 161, 91, 122, 203, 190, 57, 74, 76, 88, 206,
  209, 239, 170, 237, 32, 252, 185, 91, 190, 203, 190, 57, 74, 76, 88, 206,
  208, 238, 66, 204, 233, 186, 101, 205, 132, 54, 226, 8, 133, 125, 188, 15,
  9, 101, 44, 28, 29, 110, 84, 170, 82, 59, 214, 25, 222, 47, 41, 25,
  97, 129, 79, 220, 20, 20, 144, 26, 74, 16, 170, 20, 223, 43, 10, 219,
  224, 50, 56, 10, 73, 6, 36, 82, 194, 163, 121, 211, 25, 106, 228, 121,
  231, 5, 35, 109, 133, 250, 78, 234, 108, 86, 101, 122, 124, 122, 174, 8,
  186, 120, 37, 46, 28, 166, 181, 200, 232, 221, 116, 223, 148, 31, 139, 138,
  112, 124, 37, 93, 72, 3, 232, 110, 1, 84, 101, 29, 205, 115, 65, 46,
  225, 240, 152, 17, 14, 31, 246, 71, 107, 85, 155, 89, 90, 213, 187, 22,
  140, 161, 137, 13, 191, 230, 163, 96, 65, 153, 45, 47, 73, 84, 187, 186
}

local function r16_0(r0_3015)
  local r1_3015 = {}
  for r5_3015 = 1, 16, 1 do
    r1_3015[r5_3015] = r0_3015[17 - r5_3015]
  end
  local r2_3015 = r11_0(r1_3015)
  local r3_3015 = {}
  for r7_3015 = 1, 16, 1 do
    r3_3015[r7_3015] = r0_3015[r7_3015] ~ 90
  end
  local r4_3015 = r11_0(r3_3015, r2_3015)
  local r5_3015 = {}
  local r6_3015 = (r2_3015 ~ r4_3015 ~ 3735928559) &amp; 4294967295
  for r10_3015 = 0, 15, 1 do
    r6_3015 = r12_0(r6_3015 + r10_3015 * 74565 &amp; 4294967295)
    r5_3015[r10_3015 + 1] = (r6_3015 ~ r14_0[(r6_3015 &gt;&gt; (r10_3015 &amp; 31) &amp; 255) + 1] ~ r0_3015[r10_3015 + 1]) &amp; 255
  end
  return r5_3015
end

local r24_0 = {131, 73, 49, 35, 131, 228, 99, 178, 223, 168, 84, 165, 118, 83, 178, 67}

local processed_key = r16_0(r24_0)
print(&#34;{&#34; .. table.concat(processed_key, &#34;, &#34;) .. &#34;}&#34;)
</code></pre><p>This gives us</p>
<pre tabindex="0"><code>{178, 41, 50, 242, 52, 21, 116, 232, 122, 160, 110, 13, 188, 35, 137, 56}
</code></pre><p>Finally, we need to know what does r20_0 function does.</p>
<pre tabindex="0"><code>local function r20_0(r0_4019, r1_4019, r2_4019)
  -- line: [12219, 12231] id: 4019
  local r3_4019 = r10_0(r0_4019, 16)
  local r4_4019 = {}
  local r5_4019 = r8_0(r2_4019)
  for r9_4019 = 1, #r3_4019, 16 do
    local r10_4019 = {}
    for r14_4019 = 0, 15, 1 do
      r10_4019[r14_4019 + 1] = r3_4019[r9_4019 + r14_4019]
    end
    local r12_4019 = r19_0(r9_0(r10_4019, r5_4019), r1_4019)
    for r16_4019 = 1, 16, 1 do
      r4_4019[#r4_4019 + 1] = r12_4019[r16_4019]
    end
    r5_4019 = r12_4019
  end
  return r4_4019
end
</code></pre><p>Using AI, it does custom AES-CBC encryption, and here is the decryption script:</p>
<pre tabindex="0"><code>
key = bytes([131, 73, 49, 35, 131, 228, 99, 178, 223, 168, 84, 165, 118, 83, 178, 67])
iv  = bytes([178, 41, 50, 242, 52, 21, 116, 232, 122, 160, 110, 13, 188, 35, 137, 56])
ct  = bytes([
    250, 114, 60, 118, 65, 181, 249, 18, 67, 31, 28, 124, 135, 132, 173, 161,
    183, 49, 71, 88, 22, 212, 47, 194, 9, 127, 177, 61, 8, 188, 53, 224,
    47, 15, 243, 226, 43, 88, 249, 232, 84, 26, 226, 176, 221, 64, 202, 223
])



cipher = AES.new(key, AES.MODE_CBC, iv)
plaintext = unpad(cipher.decrypt(ct), AES.block_size)
print(&#34;FLAG:&#34;, plaintext.decode())

&#34;&#34;&#34;
# S-box (r14_0)
SBOX = [
    99, 188, 92, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118,
    202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164, 114, 192,
    183, 253, 147, 38, 54, 63, 247, 140, 52, 165, 229, 241, 113, 216, 49, 21,
    4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 175, 150, 117,
    9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214, 179, 43, 47, 42, 132,
    83, 209, 0, 237, 32, 252, 161, 91, 122, 203, 190, 57, 74, 76, 88, 206,
    209, 239, 170, 237, 32, 252, 185, 91, 190, 203, 190, 57, 74, 76, 88, 206,
    208, 238, 66, 204, 233, 186, 101, 205, 132, 54, 226, 8, 133, 125, 188, 15,
    9, 101, 44, 28, 29, 110, 84, 170, 82, 59, 214, 25, 222, 47, 41, 25,
    97, 129, 79, 220, 20, 20, 144, 26, 74, 16, 170, 20, 223, 43, 10, 219,
    224, 50, 56, 10, 73, 6, 36, 82, 194, 163, 121, 211, 25, 106, 228, 121,
    231, 5, 35, 109, 133, 250, 78, 234, 108, 86, 101, 122, 124, 122, 174, 8,
    186, 120, 37, 46, 28, 166, 181, 200, 232, 221, 116, 223, 148, 31, 139, 138,
    112, 124, 37, 93, 72, 3, 232, 110, 1, 84, 101, 29, 205, 115, 65, 46,
    225, 240, 152, 17, 14, 31, 246, 71, 107, 85, 155, 89, 90, 213, 187, 22,
    140, 161, 137, 13, 191, 230, 163, 96, 65, 153, 45, 47, 73, 84, 187, 186
]

# Helper functions
def r5_0(value, shift):
    shift = shift &amp; 31
    return ((value &lt;&lt; shift) | (value &gt;&gt; (32 - shift))) &amp; 0xFFFFFFFF

def r18_0(key_array, index):
    result = 0
    for i in range(4):
        if index + i &lt; len(key_array):
            result |= (key_array[index + i] &lt;&lt; (i * 8))
    return result &amp; 0xFFFFFFFF

def r17_0(input_bytes, round_key):
    result = []
    for i in range(8):

        key_byte = (round_key &gt;&gt; ((i % 4) * 8)) &amp; 0xFF
        

        xored = (input_bytes[i] ^ key_byte) &amp; 0xFF
        

        sbox_val = SBOX[xored]
        

        pos_val = ((i * 29) ^ round_key) &amp; 0xFF
        
        result.append((sbox_val + pos_val) &amp; 0xFF)
    
    return result

def r9_0(arr1, arr2):
    result = []
    for i in range(len(arr1)):
        val1 = arr1[i] if i &lt; len(arr1) else 0
        val2 = arr2[i] if i &lt; len(arr2) else 0
        result.append((val1 ^ val2) &amp; 0xFF)
    return result

def r19_0_encrypt(input_block, key):
    left = input_block[:8]
    right = input_block[8:16]
    round_keys = []
    for round_num in range(8):
        packed_key = r18_0(key, (round_num % 12))  # Note: Lua uses 1-based indexing
        xored_key = (packed_key ^ (round_num * 2654435761)) &amp; 0xFFFFFFFF
        round_key = r5_0(xored_key, (round_num + 3) &amp; 31)
        round_keys.append(round_key)
    for round_num in range(8):
        f_result = r17_0(right, round_keys[round_num])
        
        new_left = r9_0(left, f_result)
        
        left, right = right, new_left
    
    return left + right

def r19_0_decrypt(ciphertext_block, key):
    left = ciphertext_block[:8]
    right = ciphertext_block[8:16]
    
    round_keys = []
    for round_num in range(8):
        packed_key = r18_0(key, (round_num % 12))
        xored_key = (packed_key ^ (round_num * 2654435761)) &amp; 0xFFFFFFFF
        round_key = r5_0(xored_key, (round_num + 3) &amp; 31)
        round_keys.append(round_key)
    

    for round_num in range(7, -1, -1):  # 7, 6, 5, 4, 3, 2, 1, 0

        f_result = r17_0(left, round_keys[round_num])
        new_right = r9_0(right, f_result)
        left, right = new_right, left
    
    return left + right

def decrypt_cbc(ciphertext, key, iv):
    plaintext = []
    prev_block = iv[:]
    
    # Process each 16-byte block
    for i in range(0, len(ciphertext), 16):
        block = ciphertext[i:i+16]
        
        # Decrypt block with custom cipher
        decrypted_block = r19_0_decrypt(block, key)
        
        # XOR with previous ciphertext (CBC)
        plain_block = r9_0(decrypted_block, prev_block)
        
        plaintext.extend(plain_block)
        prev_block = block
    
    return plaintext

key = [131, 73, 49, 35, 131, 228, 99, 178, 223, 168, 84, 165, 118, 83, 178, 67]
iv = [178, 41, 50, 242, 52, 21, 116, 232, 122, 160, 110, 13, 188, 35, 137, 56]
ciphertext = [250, 114, 60, 118, 65, 181, 249, 18, 67, 31, 28, 124, 135, 132, 173, 161, 183, 49, 71, 88, 22, 212, 47, 194, 9, 127, 177, 61, 8, 188, 53, 224, 47, 15, 243, 226, 43, 88, 249, 232, 84, 26, 226, 176, 221, 64, 202, 223]

plaintext_bytes = decrypt_cbc(ciphertext, key, iv)

flag_chars = []
for byte in plaintext_bytes:
    if 32 &lt;= byte &lt;= 126:  # Printable ASCII
        flag_chars.append(chr(byte))
    elif byte &lt; 32:  # Likely padding
        break

flag = &#39;&#39;.join(flag_chars)
print(&#34;FLAG:&#34;, flag)
</code></pre><blockquote>
<p>CONCTF{lu4_w1th_cust0m3_AES_1s_k1nda_kr4zy}</p>
</blockquote>

        </article>

        
        

        
        
    </div>

    
    
    <aside class="toc">
        <div class="toc-title">On this page</div>
        <nav class="toc-nav">
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#revstarwars">[REV][Starwars]</a></li>
        <li><a href="#revyoru">[REV][Yoru]</a></li>
        <li><a href="#revroblox-active-developer">[REV][Roblox Active Developer]</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </nav>
    </aside>
    
</main>

    </div>

    
    
    


<script>
    let searchIndex = [];
    let selectedIndex = -1;
    let searchLoaded = false;

    
    const baseURL = document.querySelector('base')?.href || '/';

    
    async function loadSearchIndex() {
        if (searchLoaded) return;
        
        try {
            
            const paths = [
                '\/index.json',
                '/index.json',
                './index.json'
            ];

            for (const path of paths) {
                try {
                    const response = await fetch(path);
                    if (response.ok) {
                        searchIndex = await response.json();
                        searchLoaded = true;
                        console.log('Search index loaded:', searchIndex.length, 'pages');
                        return;
                    }
                } catch (e) {
                    continue;
                }
            }
            
            console.error('Could not load search index from any path');
        } catch (err) {
            console.error('Error loading search index:', err);
        }
    }

    
    loadSearchIndex();

    
    function openSearch() {
        const modal = document.getElementById('searchModal');
        const input = document.getElementById('searchInput');
        modal.classList.add('active');
        input.value = '';
        input.focus();
        resetResults();
        document.body.style.overflow = 'hidden';
        
        
        loadSearchIndex();
    }

    
    function closeSearch() {
        const modal = document.getElementById('searchModal');
        modal.classList.remove('active');
        document.body.style.overflow = '';
        selectedIndex = -1;
    }

    
    function resetResults() {
        const resultsContainer = document.getElementById('searchResults');
        resultsContainer.innerHTML = `
            <div class="search-empty-state">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <p>Type to start searching...</p>
                <p class="search-debug">${searchIndex.length} pages indexed</p>
            </div>
        `;
        selectedIndex = -1;
    }

    
    function escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    
    function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    
    function highlightText(text, query) {
        if (!query || !text) return text;
        const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
        return text.replace(regex, '<mark class="search-highlight">$1</mark>');
    }

    
    function getContext(content, query, contextLength = 100) {
        if (!content) return '';
        
        const lowerContent = content.toLowerCase();
        const lowerQuery = query.toLowerCase();
        const index = lowerContent.indexOf(lowerQuery);
        
        if (index === -1) {
            return content.substring(0, contextLength * 2) + (content.length > contextLength * 2 ? '...' : '');
        }
        
        const start = Math.max(0, index - contextLength);
        const end = Math.min(content.length, index + query.length + contextLength);
        
        let context = content.substring(start, end);
        
        if (start > 0) context = '...' + context;
        if (end < content.length) context = context + '...';
        
        return context;
    }

    
    function formatSection(section, parent) {
        if (parent) {
            return parent.toUpperCase();
        }
        if (!section || section === 'home') return 'HOME';
        return section.split(/[-_]/).map(word => 
            word.charAt(0).toUpperCase() + word.slice(1)
        ).join(' ').toUpperCase();
    }

    
    function performSearch(query) {
        const resultsContainer = document.getElementById('searchResults');
        
        if (!query || query.length < 1) {
            resetResults();
            return;
        }

        if (!searchLoaded || searchIndex.length === 0) {
            resultsContainer.innerHTML = `
                <div class="search-empty-state">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <p>Loading search index...</p>
                </div>
            `;
            loadSearchIndex().then(() => performSearch(query));
            return;
        }

        const lowerQuery = query.toLowerCase().trim();
        
        
        const results = searchIndex
            .map(item => {
                let score = 0;
                const titleLower = (item.title || '').toLowerCase();
                const contentLower = (item.content || '').toLowerCase();
                
                
                if (titleLower === lowerQuery) score += 100;
                
                else if (titleLower.startsWith(lowerQuery)) score += 50;
                
                else if (titleLower.includes(lowerQuery)) score += 30;
                
                
                if (contentLower.includes(lowerQuery)) {
                    score += 10;
                    
                    const matches = (contentLower.match(new RegExp(escapeRegex(lowerQuery), 'g')) || []).length;
                    score += Math.min(matches * 2, 20);
                }
                
                return { ...item, score };
            })
            .filter(item => item.score > 0)
            .sort((a, b) => b.score - a.score)
            .slice(0, 15);

        if (results.length === 0) {
            resultsContainer.innerHTML = `
                <div class="search-empty-state">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <p>No results found for "<strong>${escapeHtml(query)}</strong>"</p>
                    <p class="search-debug">Searched ${searchIndex.length} pages</p>
                </div>
            `;
            selectedIndex = -1;
            return;
        }

        let html = '<div class="search-results-list">';
        
        results.forEach((result, index) => {
            const context = getContext(result.content || '', query, 80);
            const highlightedTitle = highlightText(escapeHtml(result.title || 'Untitled'), query);
            const highlightedContext = highlightText(escapeHtml(context), query);
            const sectionName = formatSection(result.section, result.parent);
            
            html += `
                <a href="${result.permalink}" class="search-result-item" data-index="${index}">
                    <div class="result-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                        </svg>
                    </div>
                    <div class="result-content">
                        <div class="result-section">${sectionName}</div>
                        <div class="result-title">${highlightedTitle}</div>
                        ${highlightedContext ? `<div class="result-context">${highlightedContext}</div>` : ''}
                    </div>
                    <div class="result-arrow">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </div>
                </a>
            `;
        });
        
        html += '</div>';
        resultsContainer.innerHTML = html;
        selectedIndex = -1;
    }

    
    function updateSelection() {
        const items = document.querySelectorAll('.search-result-item');
        items.forEach((item, index) => {
            if (index === selectedIndex) {
                item.classList.add('selected');
                item.scrollIntoView({ block: 'nearest' });
            } else {
                item.classList.remove('selected');
            }
        });
    }

    
    function navigateToSelected() {
        const items = document.querySelectorAll('.search-result-item');
        if (selectedIndex >= 0 && selectedIndex < items.length) {
            window.location.href = items[selectedIndex].href;
        }
    }

    
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('searchInput');
        const modal = document.getElementById('searchModal');

        
        let debounceTimer;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                performSearch(e.target.value);
            }, 100);
        });

        
        document.addEventListener('keydown', (e) => {
            
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                openSearch();
            }

            
            if (!modal.classList.contains('active')) return;

            
            if (e.key === 'Escape') {
                e.preventDefault();
                closeSearch();
            }

            
            const items = document.querySelectorAll('.search-result-item');
            if (items.length === 0) return;

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
                updateSelection();
            }

            if (e.key === 'ArrowUp') {
                e.preventDefault();
                selectedIndex = Math.max(selectedIndex - 1, 0);
                updateSelection();
            }

            
            if (e.key === 'Enter') {
                e.preventDefault();
                if (selectedIndex >= 0) {
                    navigateToSelected();
                } else if (items.length > 0) {
                    window.location.href = items[0].href;
                }
            }
        });

        
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeSearch();
            }
        });

        
        document.addEventListener('mouseover', (e) => {
            const item = e.target.closest('.search-result-item');
            if (item) {
                selectedIndex = parseInt(item.dataset.index);
                updateSelection();
            }
        });
    });
</script>
<script>

window.addEventListener('scroll', () => {
    const scrollTop = window.scrollY;
    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
    
    if (docHeight > 0) {
        const progress = (scrollTop / docHeight) * 100;
        document.getElementById('readingProgress').style.width = progress + '%';
    }
});


document.addEventListener('DOMContentLoaded', () => {
    const scrollTop = window.scrollY;
    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
    
    if (docHeight > 0) {
        const progress = (scrollTop / docHeight) * 100;
        document.getElementById('readingProgress').style.width = progress + '%';
    }
});
    </script>

</body>
</html>